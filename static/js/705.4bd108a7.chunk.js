(self.webpackChunkfree_reporting=self.webpackChunkfree_reporting||[]).push([[705],{2349:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var r=n(1413),i=n(4165),o=n(5861),a=n(2791),s=(n(9836),n(5671)),u=n(3144),c=n(136),p=n(9388),d=n(8721),l=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},h=function(e){(0,c.Z)(n,e);var t=(0,p.Z)(n);function n(){var e;return(0,s.Z)(this,n),(e=t.apply(this,arguments))._host=a.createRef(),e._eventsRegistry={documentChanged:null},e}return(0,u.Z)(n,[{key:"componentDidMount",value:function(){return l(this,void 0,void 0,(0,i.Z)().mark((function e(){var t=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._designer||(this._designer=new d.l(this._host.current,{language:this.props.language,disableOpenSaveHotkeys:!1===this.props.hotkeysEnabled,customInitTemplates:this.props.customInitTemplates})),e.next=3,this._designer.setResourceProvider({getImagesList:function(){return l(t,void 0,void 0,(0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null!==(t=this.props.imageList)&&void 0!==t?t:[]);case 1:case"end":return e.stop()}}),e,this)})))},getReportsList:function(){return l(t,void 0,void 0,(0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null!==(t=this.props.reportList)&&void 0!==t?t:[]);case 1:case"end":return e.stop()}}),e,this)})))},getThemesList:function(){return l(t,void 0,void 0,(0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null!==(t=this.props.themeList)&&void 0!==t?t:[]);case 1:case"end":return e.stop()}}),e,this)})))}});case 3:return e.next=5,this.applyProps({},this.props);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"componentDidUpdate",value:function(e){return l(this,void 0,void 0,(0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._designer){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.applyProps(e,this.props);case 4:e.language!==this.props.language&&console.warn("Changing 'language' is not supported."),e.hotkeysEnabled!==this.props.hotkeysEnabled&&console.warn("Changing 'hotkeysEnabled' is not supported."),this.areDeepEqual(e.customInitTemplates,this.props.customInitTemplates)||console.warn("Changing 'customInitTemplates' is not supported.");case 7:case"end":return t.stop()}}),t,this)})))}},{key:"areDeepEqual",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}},{key:"isReportDef",value:function(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.definition)}},{key:"shouldReportUpdate",value:function(e,t){return(null===e||void 0===e?void 0:e.id)!==(null===t||void 0===t?void 0:t.id)||(null===e||void 0===e?void 0:e.displayName)!==(null===t||void 0===t?void 0:t.displayName)||(this.isReportDef(e)&&e.definition)!==(this.isReportDef(t)&&t.definition)}},{key:"applyProps",value:function(e,t){var n,r;return l(this,void 0,void 0,(0,i.Z)().mark((function o(){var a,s=this;return(0,i.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=this._designer){i.next=4;break}return console.warn("Designer is not initialized yet."),i.abrupt("return");case 4:if(!this.shouldReportUpdate(t.report,e.report)){i.next=12;break}if(!t.report){i.next=10;break}return i.next=8,a.setReport(t.report,"override");case 8:i.next=12;break;case 10:return i.next=12,a.createReport({reportType:"CPL"},"override");case 12:if(t.dataSources===e.dataSources){i.next=16;break}return i.next=16,a.setDataSourceTemplates(null!==(n=t.dataSources)&&void 0!==n?n:[]);case 16:if(t.fontSet!==e.fontSet&&(a.fontSet=null!==(r=t.fontSet)&&void 0!==r?r:"all"),this.props.documentChanged&&!this._eventsRegistry.documentChanged?this._eventsRegistry.documentChanged=a.documentChanged.register((function(e){var t,n;return null===(n=(t=s.props).documentChanged)||void 0===n?void 0:n.call(t,e)})):!this.props.documentChanged&&this._eventsRegistry.documentChanged&&(this._eventsRegistry.documentChanged(),this._eventsRegistry.documentChanged=null),t.onCreate===e.onCreate&&t.onOpen===e.onOpen&&t.onOpenFileMenu===e.onOpenFileMenu&&t.onRender===e.onRender&&t.onSave===e.onSave&&t.onSaveAs===e.onSaveAs){i.next=21;break}return i.next=21,a.setActionHandlers({onCreate:t.onCreate,onOpen:t.onOpen,onOpenFileMenu:t.onOpenFileMenu,onRender:t.onRender,onSave:t.onSave,onSaveAs:t.onSaveAs});case 21:case"end":return i.stop()}}),o,this)})))}},{key:"setReport",value:function(e,t,n){if(null==this._designer)throw new Error("Designer is not initialized yet");return this._designer.setReport(e,t,n)}},{key:"getReport",value:function(){if(!this._designer)throw new Error("Designer is not initialized yet");return this._designer.getReport()}},{key:"createReport",value:function(e,t){if(null==this._designer)throw new Error("Designer is not initialized yet");return this._designer.createReport(e,t)}},{key:"processCommand",value:function(e){if(!this._designer)throw new Error("Designer is not initialized yet");return this._designer.processCommand(e)}},{key:"render",value:function(){return a.createElement("div",{ref:this._host,style:{height:"100%"}})}}]),n}(a.Component),f=n(4577),g=n(3941),v=n(2517),m=n(1562),y=n(7321),S=n(7689),w=JSON.parse('{"id":"NewFile","displayName":"NewFile","definition":{"Name":"multisectionreport1","Width":"0in","Layers":[{"Name":"default"}],"CustomProperties":[{"Name":"DisplayType","Value":"Page"},{"Name":"SizeType","Value":"Default"},{"Name":"PaperOrientation","Value":"Portrait"}],"Page":{"PageWidth":"8.5in","PageHeight":"11in","RightMargin":"0in","LeftMargin":"0in","TopMargin":"0in","BottomMargin":"0in","Columns":1,"ColumnSpacing":"0.5in"},"DataSources":[{"Name":"DataSource","ConnectionProperties":{"DataProvider":"JSONEMBED","ConnectString":"jsondata=[\\\\n    {\\\\n        \\"newFile\\": \\"newFile\\"\\\\n    }\\\\n]"}}],"ReportSections":[{"Type":"Continuous","Name":"ContinuousSection1","Page":{"PageWidth":"8.27in","PageHeight":"11.69in","RightMargin":"0in","LeftMargin":"0in","TopMargin":"0in","BottomMargin":"0in","Columns":1,"ColumnSpacing":"0in"},"Width":"8.2527in","Body":{"Height":"11.7007in","ReportItems":[{"Type":"table","Name":"Table1","DataSetName":"DataSet","TableColumns":[{"Width":"8.2527in"}],"Details":{"TableRows":[{"Height":"11.7007in","TableCells":[{"Item":{"Type":"rectangle","Name":"Container1","ZIndex":2,"Width":"8.2527in","Height":"11.7007in"}}]}]},"Width":"8.2527in","Height":"11.7007in"}]}}],"DataSets":[{"Name":"DataSet","Fields":[{"Name":"newFile","DataField":"newFile"}],"Query":{"DataSourceName":"DataSource","CommandText":"jpath=$.*"},"CaseSensitivity":"Auto","KanatypeSensitivity":"Auto","AccentSensitivity":"Auto","WidthSensitivity":"Auto"}]}}'),C=n(7676),k=n(5367),R=n(184);var x=function(){console.log("designer renders");var e=(0,a.useRef)(),t=(0,C.il)(),n=(0,g.dd)(),s=n.asyncDispatchModal,u=n.dispatchModal,c=(0,S.s0)(),p=(0,k.a)().user;(0,a.useEffect)((function(){var t=new URLSearchParams(window.location.search).get("id");if(null!==t&&void 0!==t)try{var n=sessionStorage.getItem(t);e.current.setReport(JSON.parse(n))}catch(r){console.log(r)}else e.current.setReport(w)}),[]);var d=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=sessionStorage.getItem("fileName"))){e.next=6;break}return sessionStorage.removeItem("fileName"),e.abrupt("return",Promise.resolve({id:t.id,displayName:n}));case 6:return e.abrupt("return",new Promise((function(e){setTimeout((0,o.Z)((0,i.Z)().mark((function n(){var r;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d(t);case 2:r=n.sent,e(r);case 4:case"end":return n.stop()}}),n)}))),1e3)})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(n){var r,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(JSON.stringify(n)),r=0,"NewFile"!==n.displayName){e.next=12;break}return p.files.forEach((function(e){return r+=parseInt(e.id)})),n.id=r,e.next=7,s({type:v.o.SAVE_NEW_FILE,payload:w});case 7:return e.next=9,d(n);case 9:return e.abrupt("return",e.sent);case 12:(o=(0,f.wG)(f.Tr.PUT,f.xd.SAVE_FILE,n)).status===m.Y.FILE_SAVED_SUCCESSFUL&&t.dispatch(y.o.FILE_SAVED),n=o.data.files.find((function(e){return e.id===n.id}));case 15:return e.abrupt("return",Promise.resolve({id:n.id,displayName:n.displayName}));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,R.jsx)("div",{id:"designer-host",children:(0,R.jsx)(h,{onSave:l,ref:e,onRender:function(e){var t=JSON.stringify(e);try{sessionStorage.setItem(e.id,t),c("/Viewer?id=".concat(e.id))}catch(n){console.log(n)}},onOpen:function(){u({type:v.o.OPEN_FILES,payload:e})},onCreate:function(){return Promise.resolve((0,r.Z)({},w))}})})}},9836:function(e,t,n){n(3694)},5893:function(){}}]);
//# sourceMappingURL=705.4bd108a7.chunk.js.map